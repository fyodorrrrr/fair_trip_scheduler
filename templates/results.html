<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignment Results</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap">
    <link rel="stylesheet" href="/static/style.css">
    <style>
      .trip-badge {
        display: inline-block;
        background: #e3f2fd;
        color: #1565c0;
        border-radius: 12px;
        padding: 4px 10px;
        margin: 2px 2px 2px 0;
        font-size: 0.95em;
        font-weight: 500;
      }
      .top-earner {
        background: #e8f5e9 !important;
      }
      .low-earner {
        background: #fff3e0 !important;
      }
      .summary {
        margin-bottom: 18px;
        padding: 12px 18px;
        background: #f8fafc;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(44,62,80,0.04);
        font-size: 1.08em;
        color: #333;
        display: flex;
        gap: 24px;
        align-items: center;
        flex-wrap: wrap;
      }
      .summary-icon {
        vertical-align: middle;
        margin-right: 6px;
        opacity: 0.7;
      }
      .result-table th, .result-table td {
        vertical-align: middle;
      }
      .result-table tbody tr:nth-child(even) {
        background: #f9f9f9;
      }
      .result-table tbody tr:hover {
        background: #eaf6ff;
      }
      @media (max-width: 600px) {
        .summary { font-size: 0.98em; padding: 8px 6px; flex-direction: column; gap: 8px;}
        .container { padding: 10px; }
        .result-table th, .result-table td { padding: 8px; }
      }
    </style>
</head>
<body>
    <div class="container">
        {% set max_comp = earnings|map(attribute='1')|max %}
        {% set min_comp = earnings|map(attribute='1')|min %}
        <div class="summary">
            <span><svg class="summary-icon" width="18" height="18" fill="none" stroke="#333" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
                <strong>Total Drivers:</strong> {{ assignments|length }}</span>
            <span><svg class="summary-icon" width="18" height="18" fill="none" stroke="#333" stroke-width="2" viewBox="0 0 24 24"><path d="M8 17l4 4 4-4m-4-5v9"/></svg>
                <strong>Total Trips:</strong> {{ total_trips }}</span>
            <span><svg class="summary-icon" width="18" height="18" fill="none" stroke="#333" stroke-width="2" viewBox="0 0 24 24"><path d="M12 1v22M5 5h14v14H5z"/></svg>
                <strong>Total Compensation:</strong> ₱{{ '%.2f'|format(total_comp) }}</span>
        </div>
        <div style="overflow-x:auto;">
        <table class="result-table">
            <thead>
                <tr>
                    <th scope="col">Driver</th>
                    <th scope="col">Assigned Trips</th>
                    <th scope="col">Total Compensation</th>
                </tr>
            </thead>
            <tbody>
                {% for driver, trips in assignments.items() %}
                {% set comp = earnings[driver] %}
                <tr class="{% if comp == max_comp %}top-earner{% elif comp == min_comp %}low-earner{% endif %}">
                    <th scope="row">{{ driver }}</th>
                    <td>
                        {% for trip in trips %}
                            <span class="trip-badge">
                                {{ trip.location if trip.location is defined else trip }}
                                {% if trip.compensation is defined %}(₱{{ '%.2f'|format(trip.compensation) }}){% endif %}
                            </span>
                        {% else %}
                            <span style="color:#aaa;">None</span>
                        {% endfor %}
                    </td>
                    <td>₱{{ '%.2f'|format(comp) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>
        <div class="back-button" style="margin-top:32px;">
            <a href="/" style="text-decoration:none;">
                <button type="button" style="background:#333;color:#fff;padding:12px 28px;border-radius:6px;font-size:1rem;box-shadow:0 2px 8px rgba(44,62,80,0.08);border:none;cursor:pointer;">
                    ← Back to Assignment
                </button>
            </a>
        </div>
    </div>
</body>
</html>
